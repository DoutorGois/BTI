We have developed a fiber-optic-based probe for precise delivery of stimulation/excitation light pulses and detection of faint fluorescence signals for applications in neuroscience and optogenetics. In this design, a thin multimode fiber serves as the head of the probe to be inserted into the brain. This fiber is used to deliver light to the region of interest and guide a sample of the emission signal back to detectors. The major tradeoff in the design of such a system is to decrease the size of the fiber and intensity of input light to minimize physical damage and to avoid photobleaching/phototoxicity but to keep the signal-to-noise ratio (S/N) reasonably high. Here, the excitation light and the associated emission signal are frequency modulated. Then, the output of the detector is passed through a time lens which compresses the distributed energy of the emission signal and maximizes the instantaneous S/N. By measuring the statistics of the noise, the structure of the time lens is designed to achieve the global optimum of S/N. We have also designed side-firing fibers and a micromechanical assembly for distributed light delivery and fluorescence detection.