Learning and memory theories consider sleep and the reactivation of waking hippocampal neural patterns to be crucial for the long-term consolidation of memories. Here we propose that precisely coordinated representations across brain regions allow the inference and evaluation of causal relationships to train an internal generative model of the world. This training starts during wakefulness and strongly benefits from sleep because its recurring nested oscillations may reflect compositional operations that facilitate a hierarchical processing of information, potentially including behavioral policy evaluations. This suggests that an important function of sleep activity is to provide conditions conducive to general inference, prediction and insight, which contribute to a more robust internal model that underlies generalization and adaptive behavior.