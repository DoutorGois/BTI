Diabetic patients have a signifiantly higher risk of developing all forms of dementia. Pentamethylquercetin (PMQ) has been proven to have potential as an anti-diabetic agent. Nevertheless, whether PMQ can improve diabetes-induced cognitive dysfunction has not been investigated. To address this, we evaluated the effectiveness and underlying mechanisms of PMQ for ameliorating diabetes-related cognitive dysfunction in vivo and in vitro. Our results showed that Goto-Kakizaki (GK) rats displayed impairment in their learning abilities and memory capabilities. Furthermore, GK rats reflected cognitive dysfunction in proportion to the intensity of insulin resistance index. In addition, dendritic spine density and the % cell viability significantly decreased in hippocampus neurons. High glucose conditions induced hippocampal neurons damage, inflicted dendritic spine dysontogenesis, and reduced Akt/cAMP response element-binding protein activation. Treatment with PMQ in GK rats significantly ameliorated cognitive deficits and neuronal damage and increased dendritic spine density, at least in part, by improving insulin resistance and metabolic disorders. Furthermore, PMQ significantly activated the Akt/cAMP response element-binding protein pathway and increased the expression of memory-related proteins in the downstream part of the Akt/cAMP response element-binding protein pathway, such as synaptophysin and glutamate receptor 1. In addition, PMQ inhibited high glucose-induced cellular toxicity. LY294002 appeared to partly inhibit PMQ-mediated protective effects in hippocampal neurons. The results suggest that insulin resistance could predominantly reduce Akt/cAMP response element-binding protein activation in the brain, which is associated with a higher risk of cognitive dysfunction. PMQ could provide a new potential option for the prevention of cognitive dysfunction in diabetes.