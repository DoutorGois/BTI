Coherent network oscillations in the brain are correlated with different behavioural states. Intrinsic resonance properties of neurons provide a basis for such oscillations. In the hippocampus, CA1 pyramidal neurons show resonance at theta (theta) frequencies (2-7 Hz). To study the mechanisms underlying theta-resonance, we performed whole-cell recordings from CA1 pyramidal cells (n = 73) in rat hippocampal slices. Oscillating current injections at different frequencies (ZAP protocol), revealed clear resonance with peak impedance at 2-5 Hz at approximately 33 degrees C (increasing to approximately 7 Hz at approximately 38 degrees C). The theta-resonance showed a U-shaped voltage dependence, being strong at subthreshold, depolarized (approximately -60 mV) and hyperpolarized (approximately -80 mV) potentials, but weaker near the resting potential (-72 mV). Voltage clamp experiments revealed three non-inactivating currents operating in the subthreshold voltage range: (1) M-current (I(M)), which activated positive to -65 mV and was blocked by the M/KCNQ channel blocker XE991 (10 microM); (2) h-current (I(h)), which activated negative to -65 mV and was blocked by the h/HCN channel blocker ZD7288 (10 microM); and (3) a persistent Na(+) current (I(NaP)), which activated positive to -65 mV and was blocked by tetrodotoxin (TTX, 1 microM). In current clamp, XE991 or TTX suppressed the resonance at depolarized, but not hyperpolarized membrane potentials, whereas ZD7288 abolished the resonance only at hyperpolarized potentials. We conclude that these cells show two forms of theta-resonance: "M-resonance" generated by the M-current and persistent Na(+) current in depolarized cells, and "H-resonance" generated by the h-current in hyperpolarized cells. Computer simulations supported this interpretation. These results suggest a novel function for M/KCNQ channels in the brain: to facilitate neuronal resonance and network oscillations in cortical neurons, thus providing a basis for an oscillation-based neural code.