The western diet is known to have detrimental effects on cognition and the gut microbiota, but few studies have investigated how these may be related. Here, we examined whether a probiotic could prevent diet-induced memory deficits. Rats were pre-exposed to vehicle, low or high doses of VSL#3 for 2 weeks before half were switched from chow to a cafeteria diet (Caf) for 25 days; VSL#3 treatment continued until death. High-dose VSL#3 prevented the diet-induced memory deficits on the hippocampal-dependent place task, but the probiotic caused deficits on the perirhinal-dependent object task, irrespective of diet or dose. No differences were observed in anxiety-like behaviour on the elevated plus maze. Gut microbial diversity was dramatically decreased by Caf diet and here, VSL#3 was able to increase the abundance of some taxa contained in the probiotic such as Streptococcus and Lactobacillus and also other taxa including Butyrivibrio, which were decreased by the Caf diet. This affected the predicted profile of microbial metabolic pathways related to antioxidant and bile biosynthesis, and fat and carbohydrate metabolism. In the hippocampus, the Caf diet increased the expression of many genes related to neuroplasticity and serotonin receptor (5HT) 1A, which was normalised in Caf-High rats. Distance-based linear modelling showed that these genes were the best predictors of place memory, and related to microbiota principal component (PC) 1. Neuroplasticity genes in the perirhinal cortex were also affected and related to PC1 but object memory performance was correlated with perirhinal 5HT2C expression and microbiota PC3. These results show that probiotics can be beneficial in situations of gut dysbiosis where memory deficits are evident but may be detrimental in healthy subjects.