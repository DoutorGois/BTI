Short-term exposure to high-energy diets impairs memory but there is little data on the relative contributions of fat and sugar to these deficits or the mechanisms responsible. Here, we investigated how these different macronutrients affect memory, neuroinflammation and neuroplasticity markers and the gut microbiota. Rats were fed matched purified diets for 2weeks; Control, Sugar, Saturated Fatty Acid (SFA) or Polyunsaturated Fatty Acid (PUFA), which varied only in the percentage of energy available from sugar and the amount and type of fat. Rats consuming SFA and Sugar were impaired on hippocampal-dependent place recognition memory compared to Controls and PUFA rats, despite all rats consuming similar amounts of energy. All rats performed comparably on the object recognition task. Hippocampal and hypothalamic inflammatory markers were not substantially affected by the diets and there was no change in the neuroplasticity marker, brain-derived neurotrophic factor. Each of the diets significantly altered the microbial composition in distinct ways. Specifically, the relative abundance of 89 taxa differed significantly between groups with the majority of these changes accounted for by the Clostridiales order and within that, Lachnospiraceae and Ruminococcaceae. These taxa showed a range of macronutrient specific correlations with place memory. In addition, Distance based Linear Models found relationships between memory, inflammation-related hippocampal genes and the gut microbiota. In conclusion, our study shows that the macronutrient profile of the diet is crucial for diet-induced memory deficits and suggests a possible link between diet, the gut microbiota and hippocampal inflammatory genes.